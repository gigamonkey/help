<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta content="width=device-width,initial-scale=1" name="viewport">
  <title>Help!</title>
  <link href="/css/style.css" media="all" rel="stylesheet" type="text/css">
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dompurify@2.3.10/dist/purify.min.js"></script>
  <script type="module">
    import { $, $$ } from '/js/modules/common.js';

    const checkReady = () => {
      $('#submit').disabled = ![...$$('.required')].every((e) => e.value);
    };

    $$('.required').forEach((e) => e.oninput = checkReady);

    checkReady();

    const hand = 'âœ‹';
    const tones = ['ðŸ»', 'ðŸ¼','ðŸ½','ðŸ¾','ðŸ¿'];

    const changeTone = () => {
      const h1 = document.querySelector('h1')
      const tone = tones[Math.floor(Math.random() * tones.length)];
      const text = [...h1.innerText]; // Gotta split into actual codepoints.

      const withoutTone = text[text.length - 1] === hand ? text : text.slice(0, text.length - 1);

      h1.innerText = `${withoutTone.join('')}${tone}`;
    };

    if (false) { // Set to true to enable random rotation.
      changeTone();
      setInterval(changeTone, 5000);
    }

  </script>
</head>
<body>
  <h1>Request help âœ‹</h1>

  <form method="POST">
    <label for="problem">
      What do you need help with?
    </label>

    <textarea name="problem" class="required"></textarea>

    <label for="tried">
      What are some things you've tried? Or is there something that you think
      you need to know to solve this problem that you don't know?
    </label>

    <textarea name="tried" class="required"></textarea>

    <button id="submit">Submit</button>
  </form>

</body>
</html>
